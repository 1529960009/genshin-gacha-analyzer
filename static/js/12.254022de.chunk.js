(this["webpackJsonpgenshin-gacha-analyzer"]=this["webpackJsonpgenshin-gacha-analyzer"]||[]).push([[12],{476:function(t,e,n){"use strict";n.r(e),n.d(e,"AnalysisChart",(function(){return H}));var r=n(12),c=n(5),a=n(13),o=n(288),i=n(0),u=n(124),l=n(37),f=n(106),b=n(324),s=n(338),h=n(461),p=n(474),O=n(469),d=n(472),j=n(478);b.a([h.a,p.a,O.a,d.a,j.a]);var v=function(t){var e=t.onCreate,n=Object(f.a)(t,["onCreate"]),r=Object(i.useRef)(null);return Object(i.useEffect)((function(){var t,n;return r.current&&(t=s.b(r.current),e(t),n=function(){t.resize()},window.addEventListener("resize",n)),function(){t&&(t.dispose(),window.removeEventListener("resize",n))}}),[]),Object(c.b)("div",Object(l.a)({ref:r},n))},g=n(26),m=n(448),S=n.n(m),x=n(452),y=n.n(x),C=function(t){return new Date(t).toLocaleDateString()},w=[{pct:0,color:{r:46,g:200,b:5}},{pct:.77,color:{r:67,g:93,b:250}},{pct:1,color:{r:255,g:0,b:0}}],E=n(66);function A(){var t=Object(r.a)(["\n            text-align: center;\n            span {\n              color: grey;\n            }\n          "]);return A=function(){return t},t}function T(){var t=Object(r.a)(["\n          padding: 0 50px;\n        "]);return T=function(){return t},t}function M(){var t=Object(r.a)(["\n          height: 300px;\n        "]);return M=function(){return t},t}function R(){var t=Object(r.a)(["\n        display: inline-block;\n        width: 100%;\n        max-width: 450px;\n        text-align: left;\n        vertical-align: top;\n      "]);return R=function(){return t},t}function k(){var t=Object(r.a)(["\n          margin: 4px;\n        "]);return k=function(){return t},t}function z(){var t=Object(r.a)(["\n              display: inline-block;\n              width: 100px;\n            "]);return z=function(){return t},t}var D=function(t){var e=t.sheetName,n=t.data,r=Object(E.b)((function(){var t=function(t){return-1!==t.indexOf("\u6b66\u5668")}(e)?80:90,r=["character5","weapon5","character4","weapon4","weapon3"],c=["5\u661f\u89d2\u8272","5\u661f\u6b66\u5668","4\u661f\u89d2\u8272","4\u661f\u6b66\u5668","3\u661f\u6b66\u5668"],a=["#fac858","#ee6666","#5470c6","#91cc75","#73c0de"],o=Object.fromEntries(r.map((function(t,e){return[t,a[e]]}))),i=Object.fromEntries(r.map((function(t){return[t,0]}))),l=Object.fromEntries(r.map((function(t,e){return[t,c[e]]}))),f=[];n.forEach((function(t){5===t.\u661f\u7ea7&&f.push(t),i["".concat(function(t){return"\u6b66\u5668"===t.\u7c7b\u522b}(t)?"weapon":"character").concat(t.\u661f\u7ea7)]+=1}));var b=0===f.length?null:S()(f)[0],s=b?n.length-n.lastIndexOf(b)-1:n.length,h=r.filter((function(t){return 0!==i[t]})),p=h.map((function(t){return{value:i[t],name:l[t]}})),O=h.map((function(t){return o[t]}));return{chartSelected:Object(u.a)({},l.weapon3,!(n.length>20)),poolMax:t,chartData:p,chartColors:O,fromTime:n[0].date,toTime:n[n.length-1].date,totalCount:n.length,leftCount:s,fiveStarCount:f.length,fourStarCount:i.weapon4+i.character4,threeStarCount:i.weapon3,fiveStarHistory:f,fiveStarAverage:y()(f,(function(t){return t.\u4fdd\u5e95\u5185}))}}),[n],e),o=Object(i.useRef)(),l=Object(i.useCallback)((function(t){o.current=t;var n={fontFamily:g.c,fontStyle:"normal"};t.setOption({textStyle:{fontFamily:g.c,fontStyle:"normal"},title:{text:e,left:"center",textStyle:n},tooltip:{trigger:"item"},legend:{top:"10%",left:"center"}})}),[]);Object(i.useEffect)((function(){var t=o.current;t&&t.setOption({legend:{left:"center",selected:r.chartSelected},color:r.chartColors,series:[{name:e,type:"pie",top:50,startAngle:70,radius:"70%",data:r.chartData}]})}),[r]);var f=function(t){return function(t){for(var e=1;e<w.length-1&&!(t<w[e].pct);e++);var n=w[e-1],r=w[e],c=r.pct-n.pct,a=(t-n.pct)/c,o=1-a,i=a,u={r:Math.floor(n.color.r*o+r.color.r*i),g:Math.floor(n.color.g*o+r.color.g*i),b:Math.floor(n.color.b*o+r.color.b*i)};return"rgb("+[u.r,u.g,u.b].join(",")+")"}(t/r.poolMax)};function b(t,e,n){return Object(c.c)(c.a,{children:[Object(c.c)("span",{style:n?{color:n}:void 0,children:[Object(c.c)("span",{css:Object(a.a)(z()),children:[t,"\uff1a",e]}),"[",(o=e,i=r.totalCount,"".concat(Math.round(o/i*1e4)/100,"%")),"]"]}),Object(c.b)("br",{})]});var o,i}function s(t,e){return Object(c.c)("span",{style:{color:e},children:[" ",t," "]})}return Object(c.c)("div",{css:Object(a.a)(R()),children:[Object(c.b)(v,{css:Object(a.a)(M()),onCreate:l}),Object(c.c)("div",{css:Object(a.a)(T()),children:[Object(c.c)("p",{css:Object(a.a)(A()),children:[Object(c.b)("span",{children:C(r.fromTime)}),Object(c.b)("span",{children:" - "}),Object(c.b)("span",{children:C(r.toTime)})]}),Object(c.b)("p",{children:Object(c.c)("span",{children:["\u4e00\u5171\u62bd\u53d6",s(r.totalCount,"#1890ff"),"\u6b21, \u5df2\u7d2f\u8ba1",s(r.leftCount,f(r.leftCount)),"\u62bd\u672a\u51fa5\u661f"]})}),Object(c.b)("p",{children:[b("5\u661f",r.fiveStarCount,g.b.FIVE_STAR),b("4\u661f",r.fourStarCount,g.b.FOUR_STAR),b("3\u661f",r.threeStarCount,g.b.THREE_STAR)]}),0!==r.fiveStarHistory.length&&Object(c.c)(c.a,{children:[Object(c.c)("p",{children:["5\u661f\u5386\u53f2\u8bb0\u5f55\uff1a",r.fiveStarHistory.map((function(t){return function(t){return Object(c.c)("span",{style:{color:f(t.\u4fdd\u5e95\u5185)},css:Object(a.a)(k()),children:[t.\u540d\u79f0,"[",t.\u4fdd\u5e95\u5185,"]"]},t.\u603b\u6b21\u6570)}(t)}))]}),Object(c.c)("p",{children:["5\u661f\u5e73\u5747\u51fa\u8d27\u6b21\u6570\uff1a",s(r.fiveStarAverage.toFixed(2),f(r.fiveStarAverage))]})]})]})]})};function F(){var t=Object(r.a)(["\n          text-align: center;\n          margin: 10px 0;\n        "]);return F=function(){return t},t}var H=function(t){var e=t.sheetNames,n=t.onGetData,r=Object(i.useMemo)((function(){return e.map((function(t){return n(t)}))}),[e]);return Object(c.c)("div",{children:[Object(c.b)(o.a,{children:Object(c.c)("span",{children:["\u6b64\u9875\u9762\u53c2\u8003\u81ea\uff1a",Object(c.b)("a",{target:"_blank",href:"https://github.com/biuuu/genshin-gacha-export",children:"github\u94fe\u63a5"})]})}),Object(c.b)("div",{css:Object(a.a)(F()),children:e.map((function(t,e){var n=r[e];if(n&&0!==n.length)return Object(c.b)(D,{sheetName:t,data:n},t)})).filter((function(t){return!!t}))})]})}}}]);